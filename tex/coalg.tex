

\pdfoutput=1

\documentclass[envcountsame]{llncs}

\usepackage[utf8]{inputenc}

\usepackage[protrusion=true,expansion=true]{microtype}


\usepackage[style=numeric,
%  backref=true,
 isbn=false,
 maxnames=3,
 maxbibnames=99 ,                
 uniquename=init ,
]{biblatex}
\bibliography{literature.bib}

\usepackage{ownstylesansthm}

\usepackage{comment}
\excludecomment{Long}\includecomment{Short}
% \includecomment{Long}\excludecomment{Short}

\pagestyle{plain}

\begin{document}

\title{Non-wellfounded trees\\in intensional Martin-L\"of type theory}

\author{Benedikt Ahrens and R\'egis Spadotti}

\institute{
Institut de Recherche en Informatique de Toulouse\\
Universit\'e Paul Sabatier, 
Toulouse}

\newcommand{\fat}[1]{\textbf{#1}}
\newcommand{\M}{\constfont{M}}
\renewcommand{\root}{\constfont{root}}
\newcommand{\br}{\constfont{br}}
\newcommand{\transport}{\constfont{transport}}


\maketitle

% \tableofcontents

\begin{abstract}


 In this work, we give a category-theoretic characterisation of \textsf{M}-types in intensional Martin-L\"of type theory.
 Our results are mechanized in the proof assistant \coq.
   
  
  \end{abstract}




 


\section{Preliminaries}\label{sec:preliminaries}

In this section we present some particular categories and functors used later on, and fix some notation.


\begin{definition}[Some categories]\label{def:set_setoid}
 We denote by $\Set$ the category of types (of a fixed universe) and total functions between them in Martin-L\"of type theory. 
 A morphism $f$ in this category is denoted by $f : A \to B$.
 
 We denote by $\Setoid$ the category an object of which is a \emph{setoid}, i.e.\ a type equipped with an equivalence relation.
 A morphism between setoids is a type-theoretic function between the underlying types that is compatible in the obvious sense with the equivalence relations of the source and target setoids.
 If $A$ is a setoid, we also use $A$ to refer to its underlying type, and thus write $a:A$ for an element $a$ of the type underlying the setoid $A$. 
 We write $a\sim a'$ for related elements $a$ and $a'$ in $A$.
 We consider two parallel morphisms of setoids $f,g:A\to B$ equal if for any $a:A$ we have $fa \sim ga$.
 
 We also write $f:A\to B$ for a morphism $f$ between objects $A$ and $B$ in some category, in particular in the category of types.
 \end{definition}



\begin{definition}\label{def:eq}
 The functor $\eq : \Set\to\Setoid$ is defined as the left adjoint to the forgetful functor $U : \Setoid \to \Set$.
  Explicitly, the functor $\eq$ sends any type $X$ to the setoid $(X,=_X)$ given by the type $X$ itself, equipped
  with the propositional equality relation $=_X$ specified via Martin-L\"of's identity type on $X$.
\end{definition}


\begin{remark}[Notation for product]
  We denote the category-theoretic binary product of objects $A$ and $B$ of a category $\C$ by $A\times B$.
  We write $\pr_1(A,B) : \C(A\times B, A)$ and $\pr_2(A,B) :\C(A\times B, B)$ for the projections, occasionally omitting the 
  argument $(A,B)$.
  Given $f : \C(A, B)$ and $g : \C(A,C)$, we write $\langle f,g\rangle : \C(A,B\times C)$ for the induced map into the product such that
  $\comp{\langle f,g\rangle}{\pr_1} = f$ and $\comp{\langle f,g\rangle}{\pr_2} = g$.
\end{remark}

Both of the categories of \Cref{def:set_setoid} have binary products; they are \emph{cartesian monoidal}, i.e.\ the terminal 
object is neutral with respect to the product. Functors preserving the monoidal structure up to isomorphism
are called \emph{strong monoidal}:

\begin{definition}\label{def:monoidal_functor}
 A functor $F:\C\to\D$ between cartesian monoidal categories is \fat{strong monoidal} if, for any two objects $A$ and $B$ of $\C$,
  the morphism
 \[ \phi^F_{A,B} := \bigl\langle F(\pr_1), F(\pr_2) \bigr\rangle : \D\bigl(F(A\times B), FA\times FB\bigr)\enspace  \] 
 is an isomorphism.
 (Note that for \emph{cartesian} monoidal categories, the family $\phi$ of morphisms automatically 
  is compatible with the unitators and associators of the source and target categories, 
  since it is given by a universal property.)
\end{definition}

\begin{example}
  The functor $\eq: \Set \to \Setoid$ of \Cref{def:eq} is strong monoidal.
\end{example}


\section{Rules for $\M$-types in intensional Martin-L\"of type theory}\label{sec:rules}

We consider types of non-wellfounded trees of a given shape in Intensional Martin-L\"of type theory (IMLTT) \parencite{martin_lof}, 
a type-theoretic foundational system.
For $a,b : A$, we denote by $a = b$ the Martin-L\"of identity type between $a$ and $b$.


Suppose $A$ is a type in (intensional) Martin-L\"of type theory, and $B : A \to \Set$ is a dependent type.
The type $\M_{A,B}$ denotes trees---possibly infinite---with nodes 
from $A$ such that a node $a:A$ has \enquote{$B(a)$-many} subtrees.

The correct notion of \enquote{sameness} for non-wellfounded trees is \emph{bisimilarity} 
\parencite{DBLP:conf/types/Coquand93, DBLP:journals/corr/abs-cs-0603119},
an equivalence relation which identifies \enquote{observationally equal} trees.
A coinductive type with bisimilarity forms a setoid as in \Cref{def:set_setoid}.
We thus denote bisimilar elements using an infix $\sim$, as in $t \sim t'$. 

Here are the rules:



\input{m-rules}

\section{The category of coalgebras}

\input{m-coalgebras}


\section{Equivalence between the rules and existence of a terminal object}

\begin{lemma}
  Given $A:\Set$ and $B:A\to\Set$ in IMLTT, the following are equivalent:
%  TODO: what principles are needed?
 \begin{itemize}
  \item The axioms given in \Cref{sec:rules}.
  \item The existence of a terminal coalgebra for the functor $F_{A,B}$ as defined in \Cref{def:poly_functor}.
 \end{itemize}

\end{lemma}

 
\printbibliography


\appendix



\end{document}



















